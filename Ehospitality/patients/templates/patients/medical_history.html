{% extends 'patients/base.html' %}

{% block content %}
  <div class="container mt-4">
    <h2 class="text-center">Your Medical History</h2>

    {% if medical_history %}
      <!-- Diagnoses Section -->
      <div class="card mt-4">
        <div class="card-header">
          <h4>Diagnoses</h4>
        </div>
        <div class="card-body">
          {% if medical_history.diagnoses.all %}
            <ul>
              {% for diagnosis in medical_history.diagnoses.all %}
                <li>{{ diagnosis.name }} - {{ diagnosis.date }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No diagnoses found in your medical history.</p>
          {% endif %}
        </div>
      </div>

      <!-- Medications Section -->
      <div class="card mt-4">
        <div class="card-header">
          <h4>Medications</h4>
        </div>
        <div class="card-body">
          {% if medical_history.medications.all %}
            <ul>
              {% for medication in medical_history.medications.all %}
                <li>{{ medication.name }} - {{ medication.dosage }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No medications found in your medical history.</p>
          {% endif %}
        </div>
      </div>

      <!-- Allergies Section -->
      <div class="card mt-4">
        <div class="card-header">
          <h4>Allergies</h4>
        </div>
        <div class="card-body">
          {% if medical_history.allergies.all %}
            <ul>
              {% for allergy in medical_history.allergies.all %}
                <li>{{ allergy.name }} - {{ allergy.severity }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No allergies found in your medical history.</p>
          {% endif %}
        </div>
      </div>

      <!-- Treatment History Section -->
      <div class="card mt-4">
        <div class="card-header">
          <h4>Treatment History</h4>
        </div>
        <div class="card-body">
          {% if medical_history.treatments.all %}
            <ul>
              {% for treatment in medical_history.treatments.all %}
                <li>{{ treatment.name }} - {{ treatment.date }} - {{ treatment.result }}</li>
              {% endfor %}
            </ul>
          {% else %}
            <p>No treatment history available.</p>
          {% endif %}
        </div>
      </div>

    {% else %}
      <div class="alert alert-warning mt-4" role="alert">
        No medical history found for your account.
      </div>
    {% endif %}

    <!-- Back to Dashboard Button -->
    <div class="mt-4">
      <a href="{% url 'accounts:patient_dashboard' %}" class="btn btn-outline-primary">
        <i class="bi bi-arrow-left-short"></i> Dashboard
      </a>
    </div>
  </div>
{% endblock %}
